<?xml version="1.0" encoding="UTF-8"?>
<grid>
	<config title="IMOS炸单异常一览表" xtype="uxgrid" curd="RE"
		base="/main/sale/SaleItem/ImosFail/" fileDownloadPath="/main/mm/fileDownload2/"/>
	<search>
		<column layout="hbox" xtype="fieldcontainer">
			<column xtype="container" flex="1" layout="hbox">
				<column xtype="textfield" fieldLabel="订单编号" name="orderid" />
				<column xtype="datefield" fieldLabel="开始时间从" name="startTime"
					format="Y-m-d" />
				<column xtype="datefield" fieldLabel="到" name="startTime"
					format="Y-m-d" />
				<column xtype="textfield" fieldLabel="异常信息" name="exceptionMsg" />
			</column>
		</column>
		<column layout="hbox" xtype="fieldcontainer">
			<column xtype="container" flex="1" layout="hbox">
				<column xtype="textfield" fieldLabel="服务器名称" name="serverName" />
				<column xtype="datefield" fieldLabel="创建时间从" name="createDate"
					format="Y-m-d" />
				<column xtype="datefield" fieldLabel="到" name="createDate"
					format="Y-m-d" />
			</column>
		</column>
	</search>
	<form>
		<column name="materialHead.id" xtype="textfield" hidden="true" />
		<column name="fileType" xtype="textfield" value="XML" hidden="true"/>
		<column fieldLabel="订单编号" readOnly="true" name="order_code_posex"
			xtype="textfield" fieldStyle="background:#E6E6E6" width="200" />
		<column xtype="dictcombobox" fieldLabel="炸单服务器" name="imos_path"
			dict="IMOS_PATH" width="200" />
		<column xtype="filefield" fieldLabel="XML文件" name="file"
			width="200" buttonText="上传" />
	</form>
	<head>
		<column xtype="rownumberer" width="30" align="right" />
		<column xtype="actioncolumn" width="48" align="center" text="操作">
			<item icon="/resources/images/28.png" tooltip="编辑"
				handler="itemEditButtonClick" />
		</column>
		<column xtype="actioncolumn" width="48" align="center" text="下载">
			<item icon="/resources/images/down.png" tooltip="下载"
				handler="fileDownloadButtonClick" />
		</column>
		<column dataIndex="orderid" width="120" align="left" text="订单编号" />
		<column dataIndex="startTime" xtype="datecolumn" width="150"
			align="center" text="开始时间" format="Y-m-d H:i:s" />
		<column dataIndex="createDate" xtype="datecolumn" width="150"
			align="center" text="创建时间" format="Y-m-d H:i:s" />
		<column dataIndex="exceptionMsg" width="200" align="left" text="异常信息" />
		<column dataIndex="serverName" width="120" align="left" text="服务器名称" />
		<column dataIndex="orderStatus" width="60" align="left" text="处理状态"/>
	</head>
	<sql vname="RP_IMOS_FAIL">
	<![CDATA[ select mif.orderID as orderid, to_date(mif.starttime,'yyyy-mm-dd hh24:mi:ss') as start_time, to_date(mif.createdate,'yyyy-mm-dd hh24:mi:ss') as create_date, mif.exceptionmsg as exception_msg, mif.servername as server_name, mif.orderstatus as order_status, mif.id , (select mf.id from material_file mf where mf.pid = si.material_head_id and mf.file_type = 'XML' and nvl(mf.status, 'A') != 'X' and rownum = 1) as mf_id from mes_imos_fail mif, sale_item si where mif.orderid = si.order_code_posex and si.id in (select acm.id from act_ct_mapping acm where acm.procinstid in (select proc_inst_id_ from act_hi_actinst where act_id_ = 'receivetask1' and end_time_ is null))]]>
	</sql>
</grid>