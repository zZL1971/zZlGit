<?xml version="1.0" encoding="UTF-8"?>
<grid>
	<config title="移门算料" taskType="gp_shiftcount" eidtRowForm="SMSWeb.view.mm.base.NewMaterialBaseWindow" editRowDataCell="saleItemId,orderCodePosex,saleHeadId" controllers="sale.SaleController,mm.MyGoodsController,mm.MaterialBaseController"/>
	<search>
		<column layout="hbox" xtype="fieldcontainer">
			<column xtype="container" flex="1" layout="hbox">
				<column xtype="hiddenfield" fieldLabel="当前用户" name="assignee" value="CURR_USER_LOGIN_NO"/>
				<column xtype="textfield" fieldLabel="描述" name="maktx"/>
				<column xtype="textfield" fieldLabel="行项目编号" name="orderCodePosex" />
			</column>
		</column>
	</search>
	<head>
		<column xtype="rownumberer" width="30" align="right"/>
		<column xtype="actioncolumn" width="38" align="center" text="操作">
			<item icon="/resources/images/remarks1.png" tooltip="编辑" handler="itemEditButtonClick"/>
		</column>
		<column dataIndex="kunnr" align="center" text="客户号" width="80"/>
	    <column dataIndex="name1" align="left" text="客户名称" width="150"/>
		<column dataIndex="orderCodePosex" align="center" text="订单编号行项目" width="150"/>
		<column dataIndex="urgentDesc" width="150" align="center" text="加急类型" />
		<column dataIndex="maktx" align="left" text="描述" width="350"></column>
		<column dataIndex="amount" align="right" text="数量" width="80"/>
		<column dataIndex="saleItemId" align="center" text="行项目ID" width="0" hidden="true"/>
		
		<column dataIndex="saleHeadId" align="center" text="订单编号ID" width="0" hidden="true"/>
		<column dataIndex="groupId" width="100" align="left" text="审批用户组">
		</column>
		<column dataIndex="assignee" width="100" align="left" text="审批用户">
		</column>
		<column dataIndex="claimTime" xtype="datecolumn" width="140" align="center" text="领取时间" format="Y-m-d H:i:s"/>
	</head>
	<sql vname="bpm_task_shiftcount">
	<![CDATA[ select a.uuid,
       b.amount,
       sh.shou_da_fang as kunnr,
       (select d.name1
          from cust_header d
         where d.kunnr = sh.shou_da_fang
           and sh.id = b.pid
           and rownum = 1) as name1,
       a.group_id,
       a.assignee,
       a.claim_Time,
       b.maktx,
       b.id as sale_item_id,
       b.order_code_posex,
       b.material_head_id as id,
       b.pid as sale_head_id,
       (select s.desc_zh_cn from sys_data_dict s where trie_id='8b3GryWqjK2zU27VwJ7GBW'and s.key_val = sh.urgent_type )as urgent_desc
  from view_bpm_activity_task1 a, sale_item b, sale_header sh
 where a.uuid = b.id
   and sh.id = b.pid
   and a.group_id = 'gp_shiftcount' order by sh.urgent_type
 ]]>
	</sql>
</grid>